<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tpcom_apr.mapper.Apr_dealtr_trnMapper">
  <select id="apr_dealtr_trn_tpcom_vs2001" resultType="com.tpcom_apr.domain.Apr_dealtr_trn_tpcom_vs2001OutputVO">
    SELECT
      mbrsh_pgm_id,
      aprv_dy,
      aprv_no,
      crd_no,
      aprv_tm,
      deal_dy,
      mcht_no,
      fam_rep_mbr_id,
      mbr_id,
      slp_cd,
      deal_fg,
      deal_tm,
      prz_cd,
      oilcls_cd,
      sale_qty,
      sale_prc,
      deal_amt,
      dsc_amt,
      mcht_pnt,
      cur_pnt,
      avl_pnt,
      pnt_knd_cd,
      annfee,
      mbrsh_svc_annfee,
      refu_lmt_inc_amt,
      deal_bef_cur_pnt,
      deal_bef_avl_pnt,
      deal_bef_annfee,
      deal_bef_mbrsh_svc_annfee,
      cncl_typ,
      cs_slp_cd,
      mbrsh_svc_fg,
      dir_self_mng_fg,
      wrng_sale_lmt_exc_fg,
      incom_organ_cd,
      ans_cd,
      telgrm_no,
      trc_no,
      orgn_aprv_dy,
      orgn_aprv_no,
      orgn_deal_dy,
      usb_dy,
      rep_aprv_no,
      sttl_mcht_no,
      sttl_amt,
      sk_chrg_amt,
      contr_fg_cd,
      svc_grp_no,
      cpn_prd_cd,
      cpn_prd_qty,
      dist_cust_cpn_mng_no,
      clltbrd_no,
      coopco_cd,
      sttl_coopco_cd,
      mngco_chrg_sttl_mcht_no,
      coop_crd_Cd,
      vat_incld_yn,
      fee_apl_bas_fg,
      fee_rt,
      fee_amt,
      cash_arcpt_issu_yn,
      chip_deal_yn,
      coopco_aprv_no,
      coopco_mbr_id,
      coopco_mbr_ip_addr,
      bat_file_nm,
      telgrm_fg,
      deal_caus_cd,
      mix_sttl_yn,
      mix_sttl_tot_amt
    FROM apr_dealtr_trn
    WHERE MBRSH_PGM_ID = #{mbrsh_pgm_id}
    AND DEAL_DY = #{orgn_deal_dy}
    AND MBR_ID = (SELECT A.MBR_ID FROM CRD_MASTER_MST A WHERE A.MBRSH_PGM_ID = #{mbrsh_pgm_id} AND A.CRD_NO = #{crd_no})
    AND MCHT_NO = #{mcht_no}
    AND IF(#{mix_sttl_yn} = 'Y', MIX_STTL_TOT_AMT, DEAL_AMT) = IF(#{svc_modu_id} = 'ZRCPTXPTC0001', IF(#{mix_sttl_yn} = 'Y', MIX_STTL_TOT_AMT, DEAL_AMT), IF(#{svc_modu_id} = 'ZCPNTXDSC0001', IF(#{mix_sttl_yn} = 'Y', MIX_STTL_TOT_AMT, DEAL_AMT), #{orgn_deal_amt}))
    AND APRV_NO = IFNULL(#{orgn_deal_aprv_no}, APRV_NO)
    AND IFNULL(COOPCO_APRV_NO, 'X') = IF(#{orgn_deal_coopco_aprv_no} = '', IFNULL(COOPCO_APRV_NO, 'X'), #{orgn_deal_coopco_aprv_no})
    AND APRV_NO = REP_APRV_NO
    LIMIT 1
  </select>

  <select id="apr_dealtr_trn_tpcom_vs2002" resultType="com.tpcom_apr.domain.Apr_dealtr_trn_tpcom_vs2002OutputVO">
    SELECT
      mbrsh_pgm_id,
      aprv_dy,
      aprv_no,
      crd_no,
      aprv_tm,
      deal_dy,
      mcht_no,
      fam_rep_mbr_id,
      mbr_id,
      slp_cd,
      deal_fg,
      deal_tm,
      prz_cd,
      oilcls_cd,
      sale_qty,
      sale_prc,
      deal_amt,
      dsc_amt,
      mcht_pnt,
      cur_pnt,
      avl_pnt,
      pnt_knd_cd,
      annfee,
      mbrsh_svc_annfee,
      refu_lmt_inc_amt,
      deal_bef_cur_pnt,
      deal_bef_avl_pnt,
      deal_bef_annfee,
      deal_bef_mbrsh_svc_annfee,
      cncl_typ,
      cs_slp_cd,
      mbrsh_svc_fg,
      dir_self_mng_fg,
      wrng_sale_lmt_exc_fg,
      incom_organ_cd,
      ans_cd,
      telgrm_no,
      trc_no,
      orgn_aprv_dy,
      orgn_aprv_no,
      orgn_deal_dy,
      usb_dy,
      rep_aprv_no,
      sttl_mcht_no,
      sttl_amt,
      sk_chrg_amt,
      contr_fg_cd,
      svc_grp_no,
      cpn_prd_cd,
      cpn_prd_qty,
      dist_cust_cpn_mng_no,
      clltbrd_no,
      coopco_cd,
      sttl_coopco_cd,
      mngco_chrg_sttl_mcht_no,
      coop_crd_Cd,
      vat_incld_yn,
      fee_apl_bas_fg,
      fee_rt,
      fee_amt,
      cash_arcpt_issu_yn,
      chip_deal_yn,
      coopco_aprv_no,
      coopco_mbr_id,
      coopco_mbr_ip_addr,
      bat_file_nm,
      telgrm_fg,
      deal_caus_cd,
      mix_sttl_yn,
      mix_sttl_tot_amt
    FROM apr_dealtr_trn
    WHERE MBRSH_PGM_ID = #{mbrsh_pgm_id}
    AND DEAL_DY = #{orgn_deal_dy}
    AND MBR_ID = (SELECT A.MBR_ID FROM CRD_MASTER_MST A WHERE A.MBRSH_PGM_ID = #{mbrsh_pgm_id} AND A.CRD_NO = #{crd_no})
    AND MCHT_NO = #{mcht_no}
    AND SLP_CD != '01'
    AND IFNULL(COOPCO_APRV_NO, 'X') = IF(#{orgn_deal_coopco_aprv_no} = '', IFNULL(COOPCO_APRV_NO, 'X'), #{orgn_deal_coopco_aprv_no})
    AND REP_APRV_NO = IFNULL(#{orgn_deal_aprv_no}, REP_APRV_NO)
    AND DEAL_AMT = #{orgn_deal_amt}
    AND CS_SLP_CD = 'R'
    LIMIT 1
  </select>

  <select id="apr_dealtr_trn_tpcom_vs2003" resultType="com.tpcom_apr.domain.Apr_dealtr_trn_tpcom_vs2003OutputVO">
  </select>

  <select id="apr_dealtr_trn_tpcom_vs2004" resultType="com.tpcom_apr.domain.Apr_dealtr_trn_tpcom_vs2004OutputVO">
  </select>

  <select id="apr_dealtr_trn_tpcom_vs2035" resultType="com.tpcom_apr.domain.Apr_dealtr_trn_tpcom_vs2035OutputVO">
  </select>

</mapper>